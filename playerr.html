<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HV PHOTOGRAPHY</title>
    <style>
        /* --- Google Font Import --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap');
        
        /* --- Universal box-sizing --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        /* --- Root variables --- */
        :root {
            --primary-bg: #fefefe; --secondary-bg: #f8f8f8; --accent-color: #1a1a1a;
            --text-primary: #121212; --text-secondary: #666666; --text-light: #888888;
            --border-color: rgba(0, 0, 0, 0.08); --transition: all 0.3s ease;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08); --radius: 12px; --spacing: 0.25rem;
            --color-gray-200: oklch(92.8% 0.006 264.531); --color-white: #fff; --color-black: #000;
            --color-dark-teal: #012726; --color-teal-hover: #004D4B; --color-vibrant-teal: #005F5C;
            --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-weight-medium: 500; --font-weight-normal: 400; --font-weight-bold: 700;
            --text-base: 1rem; --text-base--line-height: 1.5; --radius-md: 0.375rem;
            --default-transition-duration: 0.15s; --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- Body styles --- */
        body { font-family: var(--font-sans); line-height: 1.6; padding-top: 80px; background-color: var(--primary-bg); overflow-x: hidden; color: var(--text-primary); }

        /* --- Header styles --- */
        .header { position: fixed; top: 0; width: 100%; z-index: 50; transition-property: all; transition-duration: 0.3s; transition-timing-function: var(--default-transition-timing-function); background-color: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08); }
        .header-container { width: 90%; margin-left: auto; margin-right: auto; max-width: 1400px; }
        .nav { padding-top: calc(var(--spacing) * 3); padding-bottom: calc(var(--spacing) * 3); display: flex; align-items: center; justify-content: space-between; }
        .nav-left { display: flex; align-items: center; gap: calc(var(--spacing) * 6); }
        .logo { margin-right: calc(var(--spacing) * 6); height: 40px; width: auto; transition: transform 0.3s ease; }
        .logo:hover { transform: scale(1.05); }
        .nav-links { display: none; align-items: center; gap: calc(var(--spacing) * 2); }
        .nav-link { padding-left: calc(var(--spacing) * 4); padding-right: calc(var(--spacing) * 4); padding-top: calc(var(--spacing) * 2); padding-bottom: calc(var(--spacing) * 2); font-size: var(--text-base); line-height: var(--text-base--line-height); font-weight: var(--font-weight-medium); color: var(--text-primary); transition-property: color, background-color; transition-duration: var(--default-transition-duration); transition-timing-function: var(--default-transition-timing-function); text-decoration: none; border-radius: var(--radius-md); position: relative; }
        .nav-link:after { content: ''; position: absolute; width: 0; height: 2px; bottom: 8px; left: 50%; background-color: var(--color-dark-teal); transition: all 0.3s ease; transform: translateX(-50%); }
        .nav-right { display: flex; align-items: center; gap: calc(var(--spacing) * 4); }
        .menu-button { display: flex; padding: calc(var(--spacing) * 1.5); border: 1px solid var(--color-dark-teal); border-radius: var(--radius-md); color: var(--color-dark-teal); background-color: transparent; cursor: pointer; transition: all 0.3s ease; }
        #mobileMenu { position: fixed; top: 0; right: 0; width: 85vw; max-width: 320px; height: 100vh; background: #ffffff; padding: 24px 16px; transform: translateX(100%); transition: transform 0.3s ease; box-shadow: -2px 0 8px rgba(0,0,0,0.1); z-index: 1000; display: flex; flex-direction: column; overflow-y: auto; }
        #mobileMenu.active { transform: translateX(0); }
        #menuOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999; display: none; }
        #menuOverlay.active { display: block; }
        .mobile-menu-close { padding: 8px; border-radius: 8px; border: none; background: transparent; transition: background 0.2s ease, transform 0.2s ease; align-self: flex-end; margin-bottom: 24px; cursor: pointer; }
        .mobile-menu-close svg { width: 24px; height: 24px; color: #4b5563; }
        .mobile-menu-content { flex-grow: 1; overflow-y: auto; }
        .mobile-nav-links { display: flex; flex-direction: column; gap: 8px; }
        .mobile-nav-link { display: block; padding: 16px 12px; font-size: 18px; font-weight: 500; color: #2d3436; text-decoration: none; border-radius: 8px; transition: background-color 0.2s ease; }
        .mobile-menu-auth { flex-shrink: 0; padding-top: 20px; border-top: 1px solid #e5e7eb; }
        .mobile-menu-auth-buttons { display: flex; flex-direction: column; gap: 12px; }
        .mobile-menu-auth-button { padding: 14px; text-align: center; border-radius: 8px; text-decoration: none; transition: background 0.2s ease; font-weight: 600; font-size: 16px; }
        .mobile-menu-auth-button.submit { background: var(--color-dark-teal); color: var(--color-white); }
        .auth-buttons { display: none; align-items: center; gap: calc(var(--spacing) * 4); }
        .auth-button { padding-left: calc(var(--spacing) * 5); padding-right: calc(var(--spacing) * 5); padding-top: calc(var(--spacing) * 2); padding-bottom: calc(var(--spacing) * 2); font-size: var(--text-base); line-height: var(--text-base--line-height); font-weight: var(--font-weight-medium); border: 1px solid var(--color-dark-teal); border-radius: var(--radius-md); color: var(--color-dark-teal); transition-property: color, background-color; transition-duration: var(--default-transition-duration); transition-timing-function: var(--default-transition-timing-function); text-decoration: none; background-color: transparent; }
        .auth-button.submit { background-color: var(--color-dark-teal); color: var(--color-white); border: none; }
        .mobile-auth-button { display: inline-block; }
        .divider { height: 1px; background-color: var(--color-gray-200); }

        /* --- Gallery Section Styles --- */
        .gallery-section { width: 100%; max-width: 1100px; text-align: center; padding: 80px 0; margin: 0 auto; }
        .gallery-section h2 { font-family: 'Playfair Display', serif; font-size: 3.2rem; font-weight: 600; color: var(--text-primary); margin-bottom: 1.5rem; line-height: 1.15; }
        .gallery-section h2 .serif { font-family: 'Playfair Display', serif; font-style: italic; color: var(--color-dark-teal); }
        .gallery-carousel { position:relative; width:100%; height:420px; perspective:1200px; overflow:hidden; touch-action:pan-y; margin: 0 auto; }
        .carousel-track{ position:absolute; width:100%; height:100%; display:flex; justify-content:center; align-items:center; transition:transform .9s cubic-bezier(.25,.8,.25,1); will-change: transform; }
        .gallery-carousel .image-wrapper { position: absolute; width: 240px; height: 360px; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 16px; box-shadow: var(--shadow); transition: all .8s cubic-bezier(.25,.8,.25,1); transform-style: preserve-3d; background-color: var(--secondary-bg); overflow: hidden; cursor: pointer; }
        .gallery-carousel .image-wrapper a { display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; text-decoration: none; color: inherit; }
        .gallery-carousel img{ max-width: 100%; max-height: 100%; width: auto; height: auto; object-fit: cover; border-radius:16px; background-color: var(--secondary-bg); -webkit-user-drag: none; }
        .pos-3{transform:translateX(-460px) scale(.75) rotateY(30deg);z-index:1}
        .pos-2{transform:translateX(-320px) scale(.85) rotateY(20deg);z-index:2}
        .pos-1{transform:translateX(-170px) scale(.95) rotateY(10deg);z-index:3}
        .pos0 {transform:translateX(0) scale(1.1);z-index:5}
        .pos1 {transform:translateX(170px) scale(.95) rotateY(-10deg);z-index:3}
        .pos2 {transform:translateX(320px) scale(.85) rotateY(-20deg);z-index:2}
        .pos3 {transform:translateX(460px) scale(.75) rotateY(-30deg);z-index:1}
        .image-wrapper:not(.pos0) a { pointer-events: none; }
        .dots{ display:flex; justify-content:center; gap:10px; margin-top:25px; }
        .dot{ width:10px; height:10px; background:#ddd; border-radius:50%; transition:.3s; cursor:pointer; }
        .dot.active{ background:var(--color-dark-teal); transform:scale(1.3) }
        .nav-btn { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; padding: 10px; cursor: pointer; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; line-height: 1; z-index: 10; display: flex; justify-content: center; align-items: center; transition: var(--transition); }
        #prev-btn { left: 10px; }
        #next-btn { right: 10px; }

        /* --- Download Section Styles --- */
        .download-section { width: 100%; padding: 10px 40px 200px 40px; display: flex; justify-content: center; align-items: center; overflow: hidden; background-color: var(--primary-bg); }
        .download-container { width: 100%; max-width: 1100px; display: flex; justify-content: space-between; align-items: center; }
        .text-content { width: 45%; z-index: 2; }
        .eyebrow-text { color: var(--color-vibrant-teal); font-size: 0.9rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1rem; }
        .text-content h2 { font-family: 'Playfair Display', serif; font-size: 3rem; font-weight: 600; line-height: 1.2; color: var(--text-primary); margin-bottom: 1.5rem; }
        .text-content h2 .serif { font-style: italic; color: var(--color-dark-teal); }
        .text-content p { font-size: 1.1rem; color: var(--text-secondary); margin: 0 0 2.5rem 0; line-height: 1.8; max-width: 480px; }
        .image-stack-container { width: 50%; position: relative; height: 450px; perspective: 1000px; }
        .image-stack-item { position: absolute; border-radius: 16px; box-shadow: 0 20px 50px -10px rgba(0,0,0,0.2); object-fit: cover; border: 5px solid white; transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); }
        #gallery-img-1 { width: 300px; height: 420px; top: 50%; left: 0; transform: translateY(-50%) rotateZ(-5deg); z-index: 1; }
        #gallery-img-2 { width: 320px; height: 240px; top: 50%; right: 0; transform: translateY(-50%) rotateZ(5deg); z-index: 3; }
        .text-content > *, .image-stack-item { opacity: 0; transform: translateY(40px); transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        .download-container.is-visible .text-content > *, .download-container.is-visible .image-stack-item { opacity: 1; transform: translateY(0); }
        .download-container.is-visible .eyebrow-text { transition-delay: 0.1s; }
        .download-container.is-visible h2 { transition-delay: 0.2s; }
        .download-container.is-visible p { transition-delay: 0.3s; }
        .download-container.is-visible .download-button { transition-delay: 0.4s; }
        .download-container.is-visible #gallery-img-1 { transition-delay: 0.2s; }
        .download-container.is-visible #gallery-img-2 { transition-delay: 0.4s; }
        .download-button { display: inline-flex; align-items: center; justify-content: center; gap: 12px; background: linear-gradient(110deg, var(--color-vibrant-teal), var(--color-dark-teal) 45%, var(--color-vibrant-teal) 55%, var(--color-dark-teal)); background-size: 250% 100%; color: #fff; border: none; padding: 18px 40px; border-radius: 12px; font-size: 1.1rem; font-weight: 600; text-decoration: none; cursor: pointer; box-shadow: 0 5px 20px rgba(1, 39, 38, 0.2); position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); animation: gradient-shimmer 4s linear infinite; }
        .download-button::before { content: ''; position: absolute; top: 0; left: -100%; width: 75%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.25), transparent); transform: skewX(-25deg); transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .download-button svg { width: 22px; height: 22px; stroke: #fff; stroke-width: 2.5; transition: transform 0.3s ease; }
        @keyframes gradient-shimmer { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

        /* --- Footer Section Styles --- */
        .footer-section { background-color: var(--color-dark-teal); padding: 80px 40px 40px; color: #ffffff; }
        .footer-content { max-width: 1200px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; text-align: center; gap: 40px; }
        .footer-logo-area { display: flex; flex-direction: column; align-items: center; gap: 16px; }
        .footer-logo-img { max-width: 140px; filter: brightness(0) invert(1); opacity: 0.9; }
        .logo-tagline { font-size: 1rem; color: #d1d5db; max-width: 400px; }
        .footer-cta { margin: 20px 0; }
        .footer-cta-button { display: inline-flex; align-items: center; justify-content: center; gap: 12px; background: #ffffff; color: var(--color-dark-teal); border: none; padding: 18px 40px; border-radius: 12px; font-size: 1.1rem; font-weight: 700; text-decoration: none; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2); }
        .footer-bottom { width: 100%; padding-top: 40px; border-top: 1px solid rgba(255, 255, 255, 0.2); display: flex; flex-direction: column; align-items: center; gap: 20px; }
        .copyright-text { color: #d1d5db; font-size: 0.9rem; }
        .footer-links { display: flex; gap: 24px; }
        .footer-links a { text-decoration: none; color: #d1d5db; font-size: 0.9rem; transition: color 0.2s ease; }
        
        /* --- Responsive Adjustments --- */
        @media (min-width: 48rem) { .nav-links { display: flex; } .menu-button { display: none; } .auth-buttons { display: flex; } .mobile-auth-button { display: none; } }
        @media (max-width: 900px){ .gallery-carousel { height: 360px; } .gallery-carousel .image-wrapper, .gallery-carousel img { max-width: 200px; max-height: 300px; } .pos-3{transform:translateX(-360px) scale(.70) rotateY(35deg)} .pos-2{transform:translateX(-240px) scale(.80) rotateY(25deg)} .pos-1{transform:translateX(-120px) scale(.90) rotateY(12deg)} .pos0 {transform:translateX(0) scale(1.05)} .pos1 {transform:translateX(120px) scale(.90) rotateY(-12deg)} .pos-2{transform:translateX(240px) scale(.80) rotateY(-25deg)} .pos3 {transform:translateX(360px) scale(.70) rotateY(-35deg)} .download-section { padding: 10px 24px; } .download-container { flex-direction: column; } .text-content, .image-stack-container { width: 100%; } .text-content { text-align: left; margin-bottom: 50px; } .image-stack-container { height: 350px; } #gallery-img-1 { width: 200px; height: 280px; transform: translateY(-50%) rotateZ(-8deg); } #gallery-img-2 { width: 220px; height: 165px; transform: translateY(-50%) rotateZ(8deg); } .download-button { display: flex; width: 100%; } }
        @media (max-width: 768px) { .gallery-carousel { height: 300px; } .gallery-carousel .image-wrapper, .gallery-carousel img { max-width: 160px; max-height: 240px; } .pos-3{transform:translateX(-280px) scale(.65)} .pos-2{transform:translateX(-190px) scale(.75)} .pos-1{transform:translateX(-95px) scale(.88)} .pos0 {transform:translateX(0) scale(1.0)} .pos1 {transform:translateX(95px) scale(.88)} .pos2 {transform:translateX(190px) scale(.75)} .pos3 {transform:translateX(280px) scale(.65)} }
    </style>
</head>
<body>
    <!-- Navbar -->
    <header class="header">
        <div class="header-container"><nav class="nav"><div class="nav-left"><a href="/"><img class="logo" src="https://ihtnas.com/assets/ihtnas-nav.png" alt="HV Photography Logo"></a><div class="nav-links"><a class="nav-link" href="#">Home</a><a class="nav-link" href="#">About</a><a class="nav-link" href="#">Services</a><a class="nav-link" href="#">Gallery</a><a class="nav-link" href="#">Contact</a></div></div><div class="nav-right"><a class="auth-button submit mobile-auth-button" href="#">Book Us</a><button class="menu-button" id="mobileMenuButton"><svg width="24" height="24" viewBox="0 0 24" fill="none"><path stroke="currentColor" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><div class="auth-buttons"><a class="auth-button submit" href="#">Book Us</a></div></div></nav><div id="mobileMenu"><div class="mobile-menu-close" id="mobileMenuClose"><svg viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></div><div class="mobile-menu-content"><div class="mobile-nav-links"><a href="#" class="mobile-nav-link">Home</a><a href="#" class="mobile-nav-link">About</a><a href="#" class="mobile-nav-link">Services</a><a href="#" class="mobile-nav-link">Gallery</a><a href="#" class="mobile-nav-link">Contact</a></div></div><div class="mobile-menu-auth"><div class="mobile-menu-auth-buttons"><a href="#" class="mobile-menu-auth-button submit">Book Us</a></div></div></div><div id="menuOverlay"></div><div class="divider"></div></div>
    </header>

    <!-- Gallery Section -->
    <section class="gallery-section">
        <h2 id="gallery-title">Explore Your <span class="serif">Gallery</span></h2>
        <div class="gallery-carousel" id="carousel-container">
            <div class="carousel-track" id="track">
                <!-- IMAGES WILL BE DYNAMICALLY INSERTED HERE -->
            </div>
            <button id="prev-btn" class="nav-btn">&#10094;</button>
            <button id="next-btn" class="nav-btn">&#10095;</button>
        </div>
        <div class="dots" id="dots"></div>
    </section>

    <!-- Download Section -->
    <section class="download-section">
        <div class="download-container">
            <div class="text-content">
                <p class="eyebrow-text">Your Memories, Delivered</p>
                <h2 id="download-title">Your Gallery is <span class="serif">Ready!</span></h2>
                <p>We've put the finishing touches on your collection. Each image has been professionally edited and is now available in high-resolution, ready to be shared and cherished.</p>
                <a href="#" class="download-button">
                    Download Your Album
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                </a>
            </div>
            <div class="image-stack-container">
                <img src="" alt="A beautiful portrait of a client" class="image-stack-item" id="gallery-img-1" data-speed="0.08" style="display: none;">
                <img src="" alt="A second beautiful portrait of a client" class="image-stack-item" id="gallery-img-2" data-speed="0.03" style="display: none;">
            </div>
        </div>
    </section>

    <!-- Footer Section -->
    <footer class="footer-section"><div class="footer-content"><div class="footer-logo-area"><img src="https://ihtnas.com/assets/ihtnas-nav.png" alt="HV Photography Logo" class="footer-logo-img"><p class="logo-tagline">Capturing Life's Timeless Moments with Professional Photography Services</p></div><div class="footer-cta"><a href="#" class="footer-cta-button">Book Your Session Now <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg></a></div><div class="footer-bottom"><p class="copyright-text">&copy; 2024 HV Photography. All rights reserved.</p><div class="footer-links"><a href="#">Privacy Policy</a><a href="#">Terms of Service</a><a href="#">Contact Us</a></div></div></div></footer>

    <!-- This script MUST be defined before the other scripts that use it -->
    <script>
        function initializeCarousel() {
            const carouselContainer = document.getElementById('carousel-container');
            if (!carouselContainer) return;

            const imageWrappers = document.querySelectorAll('.gallery-carousel .image-wrapper');
            if (imageWrappers.length === 0) {
                document.querySelector('.gallery-section').innerHTML = '<h2>This gallery has no images.</h2>';
                return;
            }

            const dotsContainer = document.getElementById('dots');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const total = imageWrappers.length;
            const positions = ['pos-3','pos-2','pos-1','pos0','pos1','pos2','pos3'];
            const offsetByClass = { 'pos-3':-3, 'pos-2':-2, 'pos-1':-1, 'pos0':0, 'pos1':1, 'pos2':2, 'pos3':3 };

            let idx = 0, auto = null;

            // Clear and create dots
            dotsContainer.innerHTML = '';
            for (let i = 0; i < total; i++) {
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.dataset.idx = i;
                dotsContainer.appendChild(dot);
            }
            const dots = document.querySelectorAll('.dot');

            function update() {
                // The number of visible positions in the carousel CSS is 7
                const visiblePositions = 7; 
                for (let i = 0; i < visiblePositions; i++) {
                    const wrapperIdx = (idx + i - Math.floor(visiblePositions / 2) + total) % total;
                    if (imageWrappers[wrapperIdx]) {
                        imageWrappers[wrapperIdx].className = 'image-wrapper ' + positions[i];
                    }
                }
                dots.forEach((d, i) => d.classList.toggle('active', i === idx));
            }

            function go(dir) {
                idx = (idx + dir + total) % total;
                update();
            }
            
            function startAuto(){ auto = setInterval(() => go(1), 3000); }
            function stopAuto(){ clearInterval(auto); }

            prevBtn.addEventListener('click', () => { stopAuto(); go(-1); startAuto(); });
            nextBtn.addEventListener('click', () => { stopAuto(); go(1); startAuto(); });

            imageWrappers.forEach((wrapper) => {
                wrapper.addEventListener('click', (e) => {
                    const cls = [...wrapper.classList].find(c => c.startsWith('pos'));
                    const offset = offsetByClass[cls] ?? 0;
                    if (offset !== 0) {
                        e.preventDefault();
                        stopAuto();
                        idx = (idx + offset + total) % total;
                        update();
                        startAuto();
                    }
                }, { capture:true });
            });
            dots.forEach(d => d.addEventListener('click', () => { stopAuto(); idx = +d.dataset.idx; update(); startAuto(); }));
            carouselContainer.addEventListener('mouseenter', stopAuto);
            carouselContainer.addEventListener('mouseleave', startAuto);

            update();
            startAuto();
        }
    </script>
    
    <!-- Firebase Player Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // IMPORTANT: Use the exact same Firebase config as in your index.html
        const firebaseConfig = {
          apiKey: "AIzaSyB-u3L7Jz3gEfXmfP7-XQfPnI2CwpJM_Vs",
          authDomain: "harsha-demo01.firebaseapp.com",
          projectId: "harsha-demo01",
          storageBucket: "harsha-demo01.firebasestorage.app",
          messagingSenderId: "676891713475",
          appId: "1:676891713475:web:a57e93657253e27a382776",
          measurementId: "G-B211571YB4"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadProjectData() {
            const gallerySection = document.querySelector('.gallery-section');
            const track = document.getElementById('track');
            const downloadButton = document.querySelector('.download-button');
            const downloadImg1 = document.getElementById('gallery-img-1');
            const downloadImg2 = document.getElementById('gallery-img-2');
            const galleryTitle = document.getElementById('gallery-title');
            const downloadTitle = document.getElementById('download-title');

            const params = new URLSearchParams(window.location.search);
            const projectId = params.get('id');

            if (!projectId) {
                gallerySection.innerHTML = `<h2>Error: No project ID provided. The link is invalid.</h2>`;
                return;
            }

            try {
                const docSnap = await getDoc(doc(db, 'projects', projectId));

                if (docSnap.exists()) {
                    const projectData = docSnap.data();
                    const allImages = projectData.imageURLs || [];
                    
                    // Update titles and download link
                    document.title = projectData.name;
                    galleryTitle.innerHTML = `Explore <span class="serif">${projectData.name}</span>`;
                    downloadTitle.innerHTML = `<span class="serif">${projectData.name}</span> is Ready!`;
                    downloadButton.href = projectData.link;

                    // Populate Download Section images (8th and 9th images)
                    if (allImages.length > 7) {
                        downloadImg1.src = allImages[7];
                        downloadImg1.style.display = 'block';
                    } else {
                        downloadImg1.style.display = 'none';
                    }

                    if (allImages.length > 8) {
                        downloadImg2.src = allImages[8];
                        downloadImg2.style.display = 'block';
                    } else {
                        downloadImg2.style.display = 'none';
                    }

                    // Populate Carousel images (first 7 images)
                    const carouselImages = allImages.slice(0, 7);
                    track.innerHTML = ''; // Clear any placeholders

                    if (carouselImages.length > 0) {
                        carouselImages.forEach(imgUrl => {
                            const imageElement = `
                                <div class="image-wrapper">
                                    <a href="${imgUrl}" target="_blank" rel="noopener noreferrer">
                                        <img src="${imgUrl}" alt="${projectData.name} Image">
                                    </a>
                                </div>`;
                            track.innerHTML += imageElement;
                        });
                        // IMPORTANT: Initialize the carousel AFTER adding the images to the DOM
                        initializeCarousel();
                    } else {
                        gallerySection.innerHTML = `<h2>This gallery has no images.</h2>`;
                    }
                } else {
                    gallerySection.innerHTML = `<h2>Error: Project not found. It may have been deleted.</h2>`;
                }
            } catch (error) {
                console.error("Error fetching project:", error);
                gallerySection.innerHTML = `<h2>An error occurred while loading the project.</h2>`;
            }
        }

        document.addEventListener('DOMContentLoaded', loadProjectData);
    </script>

    <!-- In-built JavaScript for Mobile Menu and other UI interactions -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Mobile Menu Functionality
            const mobileMenuButton = document.getElementById('mobileMenuButton');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuClose = document.getElementById('mobileMenuClose');
            const menuOverlay = document.getElementById('menuOverlay');
            const openMenu = () => { mobileMenu.classList.add('active'); menuOverlay.classList.add('active'); document.body.style.overflow = 'hidden'; };
            const closeMenu = () => { mobileMenu.classList.remove('active'); menuOverlay.classList.remove('active'); document.body.style.overflow = ''; };
            if (mobileMenuButton) mobileMenuButton.addEventListener('click', openMenu);
            if (mobileMenuClose) mobileMenuClose.addEventListener('click', closeMenu);
            if (menuOverlay) menuOverlay.addEventListener('click', closeMenu);
            document.querySelectorAll('#mobileMenu a').forEach(link => link.addEventListener('click', closeMenu));
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });

            // Download Section Intersection Observer
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.3 });
            const downloadContainer = document.querySelector('.download-container');
            if (downloadContainer) observer.observe(downloadContainer);

            // Parallax Effect on Scroll (Desktop Only)
            window.addEventListener('scroll', () => {
                if (window.innerWidth > 900) {
                    const scrollY = window.scrollY;
                    const images = document.querySelectorAll('.image-stack-item');
                    const sectionTop = document.querySelector('.download-section').offsetTop;
                    images.forEach(img => {
                        const speed = parseFloat(img.getAttribute('data-speed')) || 0;
                        const yPos = -(scrollY - sectionTop) * speed;
                        const initialTransform = getComputedStyle(img).transform;
                        const rotateValue = initialTransform.includes('matrix') ? 0 : initialTransform.split('rotateZ(')[1].split('deg)')[0];
                        img.style.transform = `translateY(${yPos}px) rotateZ(${rotateValue}deg)`;
                    });
                }
            });
        });
    </script>
</body>
</html>
